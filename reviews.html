<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tourist Review Feature</title>
    <link rel="stylesheet" href="css/reviews.css">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>
</head>
<body>
    <div class="review-container">
        <h2>Destination Review</h2>
        <form id="reviewForm">
            <textarea id="comment" name="comment" placeholder="Write your review here" required></textarea>
            <input type="file" id="image" accept="image/*">
            <div class="rating">
                <label for="star5">&#9733;</label>
                <input type="radio" id="star5" name="rating" value="5">
                <label for="star4">&#9733;</label>
                <input type="radio" id="star4" name="rating" value="4">
                <label for="star3">&#9733;</label>
                <input type="radio" id="star3" name="rating" value="3">
                <label for="star2">&#9733;</label>
                <input type="radio" id="star2" name="rating" value="2">
                <label for="star1">&#9733;</label>
                <input type="radio" id="star1" name="rating" value="1">
            </div>
            <button type="submit" class="submit-btn">Submit Review</button>
        </form>
        <div class="review-list" id="reviewList">
            <h3>Reviews</h3>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        const reviewForm = document.getElementById('reviewForm');
        const reviewList = document.getElementById('reviewList');

        reviewForm.addEventListener('submit', async function(event) {
            event.preventDefault();
            const comment = document.getElementById('comment').value;
            const rating = document.querySelector('input[name="rating"]:checked')?.value;
            const date = new Date().toLocaleString();
            const userId = `user_${Date.now()}`;
            const imageInput = document.getElementById('image');
            const imageFile = imageInput.files[0];
            let imageUrl = null;

            if (imageFile) {
                const reader = new FileReader();
                reader.onload = async function(event) {
                    imageUrl = event.target.result;
                    await db.collection("reviews").add({ comment, rating, date, image: imageUrl, userId });
                    loadReviews();
                };
                reader.readAsDataURL(imageFile);
            } else {
                await db.collection("reviews").add({ comment, rating, date, image: null, userId });
                loadReviews();
            }

            reviewForm.reset();
        });

        async function loadReviews() {
            reviewList.innerHTML = "<h3>Reviews</h3>";
            const snapshot = await db.collection("reviews").get();
            snapshot.forEach(doc => {
                displayReview(doc.id, doc.data());
            });
        }

        function displayReview(id, review) {
            const reviewDiv = document.createElement('div');
            reviewDiv.classList.add('review');
            
            const commentPara = document.createElement('p');
            commentPara.textContent = `Comment: ${review.comment}`;
            
            const ratingPara = document.createElement('p');
            ratingPara.textContent = `Rating: ${review.rating || 'No rating'}`;
            
            const datePara = document.createElement('p');
            datePara.textContent = `Date: ${review.date}`;
            
            if (review.image) {
                const img = document.createElement('img');
                img.src = review.image;
                img.alt = "Attached Image";
                reviewDiv.appendChild(img);
            }
            
            reviewDiv.appendChild(commentPara);
            reviewDiv.appendChild(ratingPara);
            reviewDiv.appendChild(datePara);
            
            reviewList.appendChild(reviewDiv);
        }

        loadReviews();
    </script>
</body>
</html>
